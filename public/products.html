<!DOCTYPE html>
<html>

<head>
    <title>B-Hub</title>
    <meta name="viewport" content="width=device-width,  initial-scale=1.0">
    <link rel="stylesheet" href="css/bhub.css" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
    <div style="width: 100%; position: absolute; top: 50px;">
        <h2
            style="position: relative; color: white; margin-left: 20px; margin-right: 20px; text-align: center; font-family: 'Lexend' sans-serif; font-size: 24px;">
            Services / Products</h2>
        <div style="width: 100%; position: relative; margin-top: 10px; display: flex; align-items: center; justify-content: center;">
            <input type="button" id="manage-svc-btn" value="MANAGE SERVICES" />
        </div>
        <div style="width: 100%; height: 1px; position: relative; background-color: darkgrey; margin-top: 40px;"></div>
        <span id="pop-cat-title">Popular services</span>
        <div id="svc-prod-list-view">
            
        </div>
        <span id="full-cat-title">Full menu</span>
        <div id="full-menu-list-view">

        </div>
        <span id="prod-cat-title">Products</span>
        <div id="prod-menu-list-view">

        </div>
        <div style="width: 100%; height: 100px;"></div>
    </div>
    <div style="width: 100%; height: 60px; background-color: black; position: fixed; top: 0%;">
        <span id="close-window-btn" class="material-symbols-outlined">arrow_back</span>
    </div>
    <script src="js/index.js"></script>
    <script>
        let popSvcItem = "";
        let fullSvcItem = "";
        let productItem = "";
        let db = firebase.firestore();
        let userId = localStorage.getItem("user_id");
        console.log(userId);

        document.getElementById('manage-svc-btn').addEventListener('click', (e) => {
            open("services.html");
        });

        document.getElementById('close-window-btn').addEventListener('click', ((e) => {
            close();
        }));

        db.collection("BHub").doc(userId).collection("Popular Services").get().then((snapshot) => {
            snapshot.forEach((doc) => {
                popSvcItem += `<div id="svc-item-row" class="${doc.data().name}">
                    <img id="svc-img-row" src="images/b_hub_logo.png" />
                    <span id="svc-name-row">${doc.data().name}</span>
                    <span id="svc-period-row">${doc.data().period}</span>
                    <span id="svc-price-row">UGX${parseInt(doc.data().price).toLocaleString()}</span>
                    <span id="svc-arrow-row" class="material-symbols-outlined">chevron_right</span>
                    <span style="width: 100%; height: 100%; position: absolute;" class="pop"></span>
                    </div>`;
                    document.getElementById('pop-cat-title').style.display = "block";
            });
            
            document.getElementById('svc-prod-list-view').innerHTML = popSvcItem;
        });
        // full menu row
        db.collection("BHub").doc(userId).collection("Full Menu Services").get().then((snapshot) => {
            snapshot.forEach((doc) => {
                fullSvcItem += `
                <div id="full-item-row" class="${doc.data().name}">
                    <img id="full-img-row" src="images/b_hub_logo.png" />
                    <span id="full-name-row">${doc.data().name}</span>
                    <span id="full-period-row">${doc.data().period}</span>
                    <span id="full-price-row">UGX${parseInt(doc.data().price).toLocaleString()}</span>
                    <span id="full-arrow-row" class="material-symbols-outlined">chevron_right</span>
                    <span style="width: 100%; height: 100%; position: absolute;" class="full"></span>
                    </div>`;
                    document.getElementById('full-cat-title').style.display = "block";
            });
            
            document.getElementById('full-menu-list-view').innerHTML = fullSvcItem;
        });
        // products
        db.collection("BHub").doc(userId).collection("Products").get().then((snapshot) => {
            snapshot.forEach((doc) => {
                productItem += `
                <div id="prod-item-row" class="${doc.data().name}">
                    <img id="prod-img-row" src="${doc.data().poster}" />
                    <span id="prod-name-row">${doc.data().name}</span>
                    <span id="prod-desc-row">${doc.data().desc}</span>
                    <span id="prod-price-row">UGX${parseInt(doc.data().price).toLocaleString()}</span>
                    <span id="prod-arrow-row" class="material-symbols-outlined">chevron_right</span>
                    <span style="width: 100%; height: 100%; position: absolute;" class="prod"></span>
                </div>`;
                document.getElementById('prod-cat-title').style.display = "block";
            });
            
            document.getElementById('prod-menu-list-view').innerHTML = productItem;
        });

        let listPop = document.querySelector("#svc-prod-list-view");
        listPop.addEventListener('click', (event) => {
            var positionClick = event.target;
            console.log(positionClick);
            if (positionClick.classList.contains('pop')) {
                var svc_name = positionClick.parentElement.classList.value;
                console.log(svc_name);
                localStorage.setItem("svc_name", svc_name);
                open("editpop.html");
            }
        });

        let listFull = document.querySelector("#full-menu-list-view");
        listFull.addEventListener('click', (event) => {
            var positionClick = event.target;
            console.log(positionClick);
            if (positionClick.classList.contains('full')) {
                var svc_name = positionClick.parentElement.classList.value;
                console.log(svc_name);
                localStorage.setItem("svc_name", svc_name);
                open("editfull.html");
            }
        });

        let listProd = document.querySelector("#prod-menu-list-view");
        listProd.addEventListener('click', (event) => {
            var positionClick = event.target;
            console.log(positionClick);
            if (positionClick.classList.contains('prod')) {
                var svc_name = positionClick.parentElement.classList.value;
                console.log(svc_name);
                localStorage.setItem("svc_name", svc_name);
                open("editprod.html");
            }
        });
    </script>
</body>

</html>